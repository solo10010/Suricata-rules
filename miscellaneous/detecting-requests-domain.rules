# Detecting requests for top-level domains

alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .tk in DNS"; flow:established; dns_query; content:".tk"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610020; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ml in DNS"; flow:established; dns_query; content:".ml"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610021; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ga in DNS"; flow:established; dns_query; content:".ga"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610022; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .cf in DNS"; flow:established; dns_query; content:".cf"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610023; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .gq in DNS"; flow:established; dns_query; content:".gq"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610024; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .work in DNS"; flow:established; dns_query; content:".work"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610025; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .date in DNS"; flow:established; dns_query; content:".date"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610026; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .top in DNS"; flow:established; dns_query; content:".top"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610027; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .review in DNS"; flow:established; dns_query; content:".review"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610028; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .stream in DNS"; flow:established; dns_query; content:".stream"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610029; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .trade in DNS"; flow:established; dns_query; content:".trade"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610030; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .loan in DNS"; flow:established; dns_query; content:".loan"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610031; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .science in DNS"; flow:established; dns_query; content:".science"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610032; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .gdn in DNS"; flow:established; dns_query; content:".gdn"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610033; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .click in DNS"; flow:established; dns_query; content:".click"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610034; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .date in DNS"; flow:established; dns_query; content:".date"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610035; rev:1;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .racing in DNS"; flow:established; dns_query; content:".racing"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610036; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .tk in HTTP Host"; flow:established; content:".tk"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610037; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ml in HTTP Host"; flow:established; content:".ml"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610038; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ga in HTTP Host"; flow:established; content:".ga"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610039; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .cf in HTTP Host"; flow:established; content:".cf"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610040; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .gq in HTTP Host"; flow:established; content:".gq"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610041; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .work in HTTP Host"; flow:established; content:".work"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610042; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .date in HTTP Host"; flow:established; content:".date"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610043; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .top in HTTP Host"; flow:established; content:".top"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610044; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .review in HTTP Host"; flow:established; content:".review"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610045; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .stream in HTTP Host"; flow:established; content:".stream"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610046; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .trade in HTTP Host"; flow:established; content:".trade"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610047; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .loan in HTTP Host"; flow:established; content:".loan"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610048; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .science in HTTP Host"; flow:established; content:".science"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610049; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .gdn in HTTP Host"; flow:established; content:".gdn"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610050; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .click in HTTP Host"; flow:established; content:".click"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610051; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .date in HTTP Host"; flow:established; content:".date"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610052; rev:1;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .racing in HTTP Host"; flow:established; content:".racing"; http_host; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610053; rev:1;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .tk in SNI"; flow:established,to_server; tls_sni; content:".tk"; endswith; classtype:bad-unknown; sid:2610054;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ml in SNI"; flow:established,to_server; tls_sni; content:".ml"; endswith; classtype:bad-unknown; sid:2610055;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ga in SNI"; flow:established,to_server; tls_sni; content:".ga"; endswith; classtype:bad-unknown; sid:2610056;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .cf in SNI"; flow:established,to_server; tls_sni; content:".cf"; endswith; classtype:bad-unknown; sid:2610057;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .gq in SNI"; flow:established,to_server; tls_sni; content:".gq"; endswith; classtype:bad-unknown; sid:2610058;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .work in SNI"; flow:established,to_server; tls_sni; content:".work"; endswith; classtype:bad-unknown; sid:2610059;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .date in SNI"; flow:established,to_server; tls_sni; content:".date"; endswith; classtype:bad-unknown; sid:2610060;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .top in SNI"; flow:established,to_server; tls_sni; content:".top"; endswith; classtype:bad-unknown; sid:2610061;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .review in SNI"; flow:established,to_server; tls_sni; content:".review"; endswith; classtype:bad-unknown; sid:2610062;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .stream in SNI"; flow:established,to_server; tls_sni; content:".stream"; endswith; classtype:bad-unknown; sid:2610063;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .trade in SNI"; flow:established,to_server; tls_sni; content:".trade"; endswith; classtype:bad-unknown; sid:2610064;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .loan in SNI"; flow:established,to_server; tls_sni; content:".loan"; endswith; classtype:bad-unknown; sid:2610065;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .science in SNI"; flow:established,to_server; tls_sni; content:".science"; endswith; classtype:bad-unknown; sid:2610066;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .gdn in SNI"; flow:established,to_server; tls_sni; content:".gdn"; endswith; classtype:bad-unknown; sid:2610067;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .click in SNI"; flow:established,to_server; tls_sni; content:".click"; endswith; classtype:bad-unknown; sid:2610068;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .date in SNI"; flow:established,to_server; tls_sni; content:".date"; endswith; classtype:bad-unknown; sid:2610069;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .racing in SNI"; flow:established,to_server; tls_sni; content:".racing"; endswith; classtype:bad-unknown; sid:2610070;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ug in DNS"; flow:established; dns_query; content:".ug"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610071; rev:1;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ug in SNI"; flow:established,to_server; tls_sni; content:".ug"; endswith; classtype:bad-unknown; sid:2610072;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ug in HTTP Host"; flow:established,to_server; content:".ug"; http_host; endswith; classtype:bad-unknown; sid:2610073;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .pw in DNS"; flow:established; dns_query; content:".pw"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610074; rev:1;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .pw in SNI"; flow:established,to_server; tls_sni; content:".pw"; endswith; classtype:bad-unknown; sid:2610075;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .pw in HTTP Host"; flow:established,to_server; content:".pw"; http_host; endswith; classtype:bad-unknown; sid:2610076;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .info in DNS"; flow:established; dns_query; content:".info"; endswith; threshold:type limit, track by_src, seconds 60, count 1; classtype:bad-unknown; sid:2610077; rev:1;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .info in SNI"; flow:established,to_server; tls_sni; content:".info"; endswith; classtype:bad-unknown; sid:2610078;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .info in HTTP Host"; flow:established,to_server; content:".info"; http_host; endswith; classtype:bad-unknown; sid:2610079;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ooo in SNI"; flow:established,to_server; tls_sni; content:".ooo"; endswith; classtype:bad-unknown; sid:2610080;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ooo in HTTP Host"; flow:established,to_server; content:".ooo"; http_host; endswith; classtype:bad-unknown; sid:2610081;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ooo in DNS Request"; flow:established,to_server; dns_query; content:".ooo"; endswith; classtype:bad-unknown; sid:2610082;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .world in SNI"; flow:established,to_server; tls_sni; content:".world"; endswith; classtype:bad-unknown; sid:2610083;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .world in HTTP Host"; flow:established,to_server; content:".world"; http_host; endswith; classtype:bad-unknown; sid:2610084;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .world in DNS Request"; flow:established,to_server; dns_query; content:".world"; endswith; classtype:bad-unknown; sid:2610085;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .desi in SNI"; flow:established,to_server; tls_sni; content:".desi"; endswith; classtype:bad-unknown; sid:2610086;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .desi in HTTP Host"; flow:established,to_server; content:".desi"; http_host; endswith; classtype:bad-unknown; sid:2610087;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .desi in DNS Request"; flow:established,to_server; dns_query; content:".desi"; endswith; classtype:bad-unknown; sid:2610088;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .life in SNI"; flow:established,to_server; tls_sni; content:".life"; endswith; classtype:bad-unknown; sid:2610089;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .life in HTTP Host"; flow:established,to_server; content:".life"; http_host; endswith; classtype:bad-unknown; sid:2610090;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .life in DNS Request"; flow:established,to_server; dns_query; content:".life"; endswith; classtype:bad-unknown; sid:2610091;)
alert tls any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ryukyu in SNI"; flow:established,to_server; tls_sni; content:".ryukyu"; endswith; classtype:bad-unknown; sid:2610092;)
alert http any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ryukyu in HTTP Host"; flow:established,to_server; content:".ryukyu"; http_host; endswith; classtype:bad-unknown; sid:2610093;)
alert dns any any -> any any (msg:"TThreatHunter Rule - Abused TLD .ryukyu in DNS Request"; flow:established,to_server; dns_query; content:".ryukyu"; endswith; classtype:bad-unknown; sid:2610094;)